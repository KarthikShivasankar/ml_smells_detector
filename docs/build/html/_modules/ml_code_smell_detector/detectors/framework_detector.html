<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ml_code_smell_detector.detectors.framework_detector &mdash; ML Code Smell Detector 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=01f34227"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ML Code Smell Detector
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../detectors/index.html">Detectors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ML Code Smell Detector</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ml_code_smell_detector.detectors.framework_detector</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ml_code_smell_detector.detectors.framework_detector</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">astroid</span>
<span class="kn">from</span> <span class="nn">astroid</span> <span class="kn">import</span> <span class="n">nodes</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">sys</span>

<div class="viewcode-block" id="FrameworkSpecificSmellDetector">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector">[docs]</a>
<span class="k">class</span> <span class="nc">FrameworkSpecificSmellDetector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A detector for identifying code smells specific to ML frameworks like Pandas, NumPy, Scikit-learn, PyTorch and TensorFlow.</span>
<span class="sd">    </span>
<span class="sd">    This class analyzes Python code to detect common anti-patterns and suboptimal implementations</span>
<span class="sd">    when using popular machine learning frameworks. It provides suggestions for improvements</span>
<span class="sd">    and best practices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">framework_smells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_smells</span><span class="p">()</span>

<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze a Python file for framework-specific code smells.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: Path to the Python file to analyze</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of dictionaries containing detected code smells with details like:</span>
<span class="sd">            - framework: The ML framework the smell relates to</span>
<span class="sd">            - name: Name of the code smell</span>
<span class="sd">            - how_to_fix: Instructions for fixing the issue</span>
<span class="sd">            - benefits: Benefits of fixing the issue</span>
<span class="sd">            - line_number: Line where the smell was detected</span>
<span class="sd">            - code_snippet: The problematic code</span>
<span class="sd">            - file_path: Path to the file containing the smell</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">module</span> <span class="o">=</span> <span class="n">astroid</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">module_name</span><span class="o">=</span><span class="n">file_path</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Could not parse module for </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">smells</span>

            <span class="n">frameworks_used</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frameworks_used</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">frameworks_used</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Could not determine frameworks for </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">smells</span>
            
            <span class="k">if</span> <span class="n">frameworks_used</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">visit_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">frameworks_used</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping framework-specific smell detection for </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: No relevant frameworks imported&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">astroid</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">AstroidSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error while processing </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">smells</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.get_frameworks_used">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.get_frameworks_used">[docs]</a>
    <span class="k">def</span> <span class="nf">get_frameworks_used</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect which ML frameworks are imported in the code.</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of framework names found in imports (e.g. [&#39;Pandas&#39;, &#39;NumPy&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        
        <span class="n">frameworks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">framework_imports</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;pandas&#39;</span><span class="p">:</span> <span class="s1">&#39;Pandas&#39;</span><span class="p">,</span>
            <span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="s1">&#39;NumPy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sklearn&#39;</span><span class="p">:</span> <span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tensorflow&#39;</span><span class="p">:</span> <span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span>
            <span class="s1">&#39;torch&#39;</span><span class="p">:</span> <span class="s1">&#39;PyTorch&#39;</span>
        <span class="p">}</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">import_node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">((</span><span class="n">nodes</span><span class="o">.</span><span class="n">Import</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ImportFrom</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">import_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Import</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">import_node</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">framework_imports</span><span class="p">:</span>
                            <span class="n">frameworks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">framework_imports</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">import_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ImportFrom</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">import_node</span><span class="o">.</span><span class="n">modname</span> <span class="ow">in</span> <span class="n">framework_imports</span><span class="p">:</span>
                        <span class="n">frameworks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">framework_imports</span><span class="p">[</span><span class="n">import_node</span><span class="o">.</span><span class="n">modname</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in get_frameworks_used: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
        
        <span class="k">return</span> <span class="n">frameworks</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.visit_module">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.visit_module">[docs]</a>
    <span class="k">def</span> <span class="nf">visit_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">frameworks_used</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Visit a Python module to detect framework-specific smells.</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed  </span>
<span class="sd">            frameworks_used: List of frameworks detected in the code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">frameworks_used</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_imports</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">framework</span> <span class="ow">in</span> <span class="n">frameworks_used</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">framework</span><span class="p">:</span>
                    <span class="n">detector_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;detect_</span><span class="si">{</span><span class="n">framework</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">_smells&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">detector_method</span><span class="p">:</span>
                        <span class="n">detector_method</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in visit_module for </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.add_smell">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.add_smell">[docs]</a>
    <span class="k">def</span> <span class="nf">add_smell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">framework</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">smell_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">NodeNG</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a detected code smell to the results.</span>

<span class="sd">        Args:</span>
<span class="sd">            framework: Name of the framework (e.g. &#39;Pandas&#39;, &#39;NumPy&#39;)</span>
<span class="sd">            smell_name: Name of the detected smell</span>
<span class="sd">            node: AST node where the smell was found</span>
<span class="sd">            file_path: Path to the file containing the smell</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">smell</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework_smells</span><span class="p">[</span><span class="n">framework</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">smell_name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">smell</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smells</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;framework&quot;</span><span class="p">:</span> <span class="n">framework</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;how_to_fix&#39;</span><span class="p">],</span>
                <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;benefits&#39;</span><span class="p">],</span>
                <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;strategies&#39;</span><span class="p">],</span>
                <span class="s2">&quot;line_number&quot;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="s2">&quot;code_snippet&quot;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">(),</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="n">file_path</span>
            <span class="p">})</span></div>


    <span class="c1"># Pandas Detection Methods</span>
<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pandas_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pandas_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pandas_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect Pandas-specific code smells like:</span>
<span class="sd">        - Unnecessary iteration instead of vectorization</span>
<span class="sd">        - Chain indexing</span>
<span class="sd">        - Missing merge parameters</span>
<span class="sd">        - Inplace operations</span>
<span class="sd">        - Inefficient values usage</span>
<span class="sd">        - Missing dtype specifications</span>
<span class="sd">        - Suboptimal column selection</span>
<span class="sd">        - DataFrame modifications in loops</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_iterrows_usage</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_chain_indexing</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_merge_parameters</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_inplace_operations</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_values_usage</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_dtype_specification</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_column_selection</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_dataframe_modification</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_iterrows_usage">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_iterrows_usage">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_iterrows_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Only flag iterrows if better alternatives could be used</span>
        <span class="n">vectorizable_operations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;apply&#39;</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;iterrows&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check if the iterrows is used within a loop</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">vectorizable_operations</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;Unnecessary Iteration&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_chain_indexing">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_chain_indexing">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_chain_indexing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Subscript</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Subscript</span><span class="p">):</span>
                <span class="c1"># Only flag if it&#39;s not within a with pd.option_context block</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">subscript</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">With</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">parent</span> <span class="ow">or</span> <span class="s1">&#39;option_context&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                    <span class="c1"># Check if it&#39;s an assignment (more dangerous) vs just access</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;Chain Indexing&#39;</span><span class="p">,</span> <span class="n">subscript</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_merge_parameters">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_merge_parameters">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_merge_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;merge&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> 
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">)</span> <span class="ow">and</span> 
                <span class="c1"># Check if it&#39;s actually a pandas merge</span>
                <span class="p">(</span><span class="s1">&#39;pd&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;pandas&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span> <span class="ow">and</span> 
                <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;how&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="s1">&#39;validate&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;Merge Parameter Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_inplace_operations">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_inplace_operations">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_inplace_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">inplace_operations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sort_values&#39;</span><span class="p">,</span> <span class="s1">&#39;fillna&#39;</span><span class="p">,</span> <span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="s1">&#39;rename&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;inplace=True&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> 
                <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">inplace_operations</span><span class="p">)):</span>
                <span class="c1"># Check if the result is used later</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">):</span>
                        <span class="k">break</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;InPlace Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_values_usage">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_values_usage">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_values_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;.values&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check if it&#39;s used in a context where to_numpy() would be better</span>
                <span class="n">numpy_contexts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;np.&#39;</span><span class="p">,</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;asarray&#39;</span><span class="p">,</span> <span class="s1">&#39;reshape&#39;</span><span class="p">,</span> <span class="s1">&#39;transpose&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">ctx</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">ctx</span> <span class="ow">in</span> <span class="n">numpy_contexts</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;DataFrame Conversion Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_dtype_specification">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_dtype_specification">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_dtype_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;read_csv&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> 
                <span class="c1"># Check if it&#39;s actually pandas read_csv</span>
                <span class="p">(</span><span class="s1">&#39;pd&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;pandas&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;parse_dates&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">)):</span>
                <span class="c1"># Check if the DataFrame is used in operations sensitive to dtypes</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">parent</span>
                <span class="n">dtype_sensitive_ops</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;groupby&#39;</span><span class="p">,</span> <span class="s1">&#39;merge&#39;</span><span class="p">,</span> <span class="s1">&#39;join&#39;</span><span class="p">,</span> <span class="s1">&#39;sort_values&#39;</span><span class="p">,</span> <span class="s1">&#39;arithmetic_operations&#39;</span><span class="p">]</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">dtype_sensitive_ops</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;Datatype Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_column_selection">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_column_selection">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_column_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Only check if there are actual DataFrame operations</span>
        <span class="n">df_operations</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">column_selections</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Subscript</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscript</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                <span class="c1"># Look for DataFrame operations</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DataFrame&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">]):</span>
                    <span class="n">df_operations</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="s1">&#39;[[&#39;</span> <span class="ow">in</span> <span class="n">subscript</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                        <span class="n">column_selections</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
        
        <span class="k">if</span> <span class="n">df_operations</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">column_selections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;Column Selection Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_dataframe_modification">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_dataframe_modification">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_dataframe_modification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">assign</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">assign</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Subscript</span><span class="p">)</span> <span class="ow">and</span> 
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">assign</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)):</span>
                <span class="c1"># Check if it&#39;s within a loop and modifying a DataFrame</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">assign</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                
                <span class="c1"># Check if it&#39;s actually a DataFrame modification</span>
                <span class="n">df_indicators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DataFrame&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">parent</span> <span class="ow">and</span> 
                    <span class="nb">any</span><span class="p">(</span><span class="n">indicator</span> <span class="ow">in</span> <span class="n">assign</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">df_indicators</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">safe_op</span> <span class="ow">in</span> <span class="n">assign</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">safe_op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="s1">&#39;iloc&#39;</span><span class="p">,</span> <span class="s1">&#39;at&#39;</span><span class="p">,</span> <span class="s1">&#39;iat&#39;</span><span class="p">])):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span> <span class="s1">&#39;DataFrame Iteration Modification&#39;</span><span class="p">,</span> <span class="n">assign</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


    <span class="c1"># NumPy Detection Methods</span>
<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_numpy_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_numpy_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_numpy_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect NumPy-specific code smells like:</span>
<span class="sd">        - NaN equality comparisons</span>
<span class="sd">        - Missing random seeds</span>
<span class="sd">        - Inefficient array creation</span>
<span class="sd">        - Non-vectorized operations</span>
<span class="sd">        - Dtype inconsistencies</span>
<span class="sd">        - Broadcasting issues</span>
<span class="sd">        - Copy/view confusion</span>
<span class="sd">        - Missing axis specifications</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_nan_equality</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_random_seed</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_array_creation</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_inefficient_operations</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_dtype_consistency</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_broadcasting_issues</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_copy_view_issues</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_axis_specification</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_nan_equality">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_nan_equality">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_nan_equality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">compare</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Compare</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;np.nan&#39;</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;as_string&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">compare</span><span class="o">.</span><span class="n">ops</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;NaN Equality Checker&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_random_seed">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_random_seed">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># List of numpy random operations to check for</span>
        <span class="n">random_operations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;np.random.rand&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.randn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.randint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.choice&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.shuffle&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.permutation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.normal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;np.random.uniform&#39;</span>
        <span class="p">]</span>
        
        <span class="c1"># Find all random operation calls</span>
        <span class="n">random_op_calls</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">random_operations</span><span class="p">)</span>
        <span class="p">]</span>
        
        <span class="c1"># Find all random seed calls</span>
        <span class="n">random_seed_calls</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;np.random.seed&#39;</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)()</span>
        <span class="p">]</span>
        
        <span class="c1"># Only trigger smell if random operations are used without seed</span>
        <span class="k">if</span> <span class="n">random_op_calls</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">random_seed_calls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Randomness Control Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_array_creation">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_array_creation">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_array_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect inefficient array creation patterns&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="c1"># Check for list to array conversion without dtype</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;np.array&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> 
                <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;dtype&#39;</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Array Creation Efficiency&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
            
            <span class="c1"># Check for zeros/ones/empty without dtype</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">func</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;np.zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;np.ones&#39;</span><span class="p">,</span> <span class="s1">&#39;np.empty&#39;</span><span class="p">])</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;dtype&#39;</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Array Creation Efficiency&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_inefficient_operations">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_inefficient_operations">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_inefficient_operations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect inefficient numerical operations&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">loop</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
            <span class="c1"># Check for element-wise operations in loops</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">loop</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;np.sum&#39;</span><span class="p">,</span> <span class="s1">&#39;np.mean&#39;</span><span class="p">,</span> <span class="s1">&#39;np.max&#39;</span><span class="p">,</span> <span class="s1">&#39;np.min&#39;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Vectorization Opportunity&#39;</span><span class="p">,</span> <span class="n">loop</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        
        <span class="c1"># Check for inefficient concatenation</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;np.concatenate&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>  <span class="c1"># If concatenate is inside a loop</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Inefficient Concatenation&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_dtype_consistency">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_dtype_consistency">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_dtype_consistency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect potential dtype inconsistency issues&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">binop</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">BinOp</span><span class="p">):</span>
            <span class="c1"># Check for mixed integer and float operations</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="ow">and</span>
                <span class="s1">&#39;np.&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;np.&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()):</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;float&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span> <span class="ow">or</span> \
                   <span class="p">(</span><span class="s1">&#39;float&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;int&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Dtype Consistency&#39;</span><span class="p">,</span> <span class="n">binop</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_broadcasting_issues">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_broadcasting_issues">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_broadcasting_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect potential broadcasting issues&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">binop</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">BinOp</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                <span class="c1"># Check for operations between arrays that might have broadcasting issues</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;reshape&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;reshape&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
                    <span class="s1">&#39;transpose&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;transpose&#39;</span> <span class="ow">in</span> <span class="n">binop</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">as_string</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Broadcasting Risk&#39;</span><span class="p">,</span> <span class="n">binop</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_copy_view_issues">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_copy_view_issues">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_copy_view_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect potential copy/view confusion&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">assign</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assign</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Subscript</span><span class="p">):</span>
                <span class="c1"># Check for array slicing without explicit copy</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">method</span> <span class="ow">in</span> <span class="n">assign</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.copy()&#39;</span><span class="p">,</span> <span class="s1">&#39;np.copy&#39;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Copy-View Confusion&#39;</span><span class="p">,</span> <span class="n">assign</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_axis_specification">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_axis_specification">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_axis_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect missing axis specifications in array operations&quot;&quot;&quot;</span>
        <span class="n">axis_operations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;argmax&#39;</span><span class="p">,</span> <span class="s1">&#39;argmin&#39;</span><span class="p">,</span> <span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">axis_operations</span><span class="p">)</span> <span class="ow">and</span>
                <span class="s1">&#39;np.&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span> <span class="ow">and</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># axis can also be specified as positional argument</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;NumPy&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing Axis Specification&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


    <span class="c1"># Scikit-learn Detection Methods</span>
<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_sklearn_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_sklearn_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_sklearn_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect Scikit-learn specific code smells like:</span>
<span class="sd">        - Missing data scaling</span>
<span class="sd">        - Not using pipelines</span>
<span class="sd">        - Missing cross validation</span>
<span class="sd">        - Missing random state</span>
<span class="sd">        - Missing verbose mode</span>
<span class="sd">        - Using only threshold-dependent metrics</span>
<span class="sd">        - Missing unit tests</span>
<span class="sd">        - Data leakage risks</span>
<span class="sd">        - Missing exception handling</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_scaling_usage</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pipeline_usage</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_cross_validation</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_random_state</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_verbose_mode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_threshold_metrics</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_unit_tests</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_data_leakage</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_exception_handling</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_scaling_usage">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_scaling_usage">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_scaling_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">scaling_sensitive_estimators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;SVM&#39;</span><span class="p">,</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span> <span class="s1">&#39;PCA&#39;</span><span class="p">,</span> <span class="s1">&#39;KMeans&#39;</span><span class="p">,</span> <span class="s1">&#39;NeuralNetwork&#39;</span><span class="p">,</span> <span class="s1">&#39;LogisticRegression&#39;</span>
        <span class="p">]</span>
        <span class="n">scaling_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;StandardScaler&#39;</span><span class="p">,</span> <span class="s1">&#39;MinMaxScaler&#39;</span><span class="p">,</span> <span class="s1">&#39;RobustScaler&#39;</span><span class="p">]</span>
        
        <span class="c1"># Check if scaling-sensitive estimators are used</span>
        <span class="n">has_sensitive_estimator</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">estimator</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">scaling_sensitive_estimators</span>
        <span class="p">)</span>
        
        <span class="c1"># Check if any scaling is applied</span>
        <span class="n">has_scaling</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">method</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">scaling_methods</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if using sensitive estimators without scaling</span>
        <span class="k">if</span> <span class="n">has_sensitive_estimator</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_scaling</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Scaler Missing Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pipeline_usage">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pipeline_usage">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pipeline_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there are multiple preprocessing or model fitting steps</span>
        <span class="n">preprocessing_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;StandardScaler&#39;</span><span class="p">,</span> <span class="s1">&#39;MinMaxScaler&#39;</span><span class="p">,</span> <span class="s1">&#39;PCA&#39;</span><span class="p">,</span> <span class="s1">&#39;SelectKBest&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;PolynomialFeatures&#39;</span><span class="p">,</span> <span class="s1">&#39;OneHotEncoder&#39;</span><span class="p">,</span> <span class="s1">&#39;LabelEncoder&#39;</span>
        <span class="p">]</span>
        <span class="n">model_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;fit_transform&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_preprocessing</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">step</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">preprocessing_steps</span>
        <span class="p">)</span>
        <span class="n">has_model_steps</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">step</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">model_steps</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest Pipeline if multiple steps are present</span>
        <span class="k">if</span> <span class="n">has_preprocessing</span> <span class="ow">and</span> <span class="n">has_model_steps</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;Pipeline&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Pipeline Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_cross_validation">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_cross_validation">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_cross_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if model training is performed</span>
        <span class="n">training_indicators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">]</span>
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">training_indicators</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for any cross-validation technique</span>
        <span class="n">cv_methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;cross_val_score&#39;</span><span class="p">,</span> <span class="s1">&#39;KFold&#39;</span><span class="p">,</span> <span class="s1">&#39;StratifiedKFold&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;cross_validate&#39;</span><span class="p">,</span> <span class="s1">&#39;GridSearchCV&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomizedSearchCV&#39;</span>
        <span class="p">]</span>
        <span class="n">has_cv</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">method</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">cv_methods</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest cross-validation for model training scenarios</span>
        <span class="k">if</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_cv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Cross Validation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_random_state">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_random_state">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># List of methods that accept random_state</span>
        <span class="n">random_state_methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;train_test_split&#39;</span><span class="p">,</span> <span class="s1">&#39;KFold&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomForest&#39;</span><span class="p">,</span> <span class="s1">&#39;KMeans&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PCA&#39;</span><span class="p">,</span> <span class="s1">&#39;shuffle&#39;</span><span class="p">,</span> <span class="s1">&#39;random_state&#39;</span>
        <span class="p">]</span>
        
        <span class="c1"># Check if any random-dependent operations are used</span>
        <span class="n">random_dependent_calls</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">method</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">random_state_methods</span><span class="p">)</span>
        <span class="p">]</span>
        
        <span class="c1"># Check if random_state is set for these calls</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">random_dependent_calls</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;random_state&#39;</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Randomness Control Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_verbose_mode">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_verbose_mode">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_verbose_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Only check for verbose in time-consuming operations</span>
        <span class="n">time_consuming_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;GridSearchCV&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomizedSearchCV&#39;</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;RandomForest&#39;</span><span class="p">,</span> <span class="s1">&#39;GradientBoosting&#39;</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">time_consuming_ops</span><span class="p">)</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;verbose&#39;</span> <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Verbose Mode Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_threshold_metrics">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_threshold_metrics">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_threshold_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Only check for classification-related tasks</span>
        <span class="n">classification_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">,</span> <span class="s1">&#39;accuracy_score&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;precision_score&#39;</span><span class="p">,</span> <span class="s1">&#39;recall_score&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_score&#39;</span><span class="p">,</span>
            <span class="s1">&#39;classification_report&#39;</span>
        <span class="p">]</span>
        
        <span class="c1"># Check if it&#39;s a classification task</span>
        <span class="n">is_classification</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">classification_indicators</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for threshold-independent metrics</span>
        <span class="n">threshold_independent_metrics</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;roc_auc_score&#39;</span><span class="p">,</span> <span class="s1">&#39;average_precision_score&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;precision_recall_curve&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_curve&#39;</span>
        <span class="p">]</span>
        <span class="n">has_threshold_metrics</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">metric</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">threshold_independent_metrics</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest threshold-independent metrics for classification tasks</span>
        <span class="k">if</span> <span class="n">is_classification</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_threshold_metrics</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Dependent Threshold Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_unit_tests">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_unit_tests">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_unit_tests</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if this is a source file (not already a test file)</span>
        <span class="n">is_test_file</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span> <span class="ow">in</span> <span class="n">file_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> 
                       <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
        
        <span class="c1"># Check for model training or evaluation code</span>
        <span class="n">ml_operations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;cross_val_score&#39;</span><span class="p">,</span> <span class="s1">&#39;GridSearchCV&#39;</span>
        <span class="p">]</span>
        <span class="n">has_ml_operations</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ml_operations</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for testing frameworks</span>
        <span class="n">test_frameworks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;unittest&#39;</span><span class="p">,</span> <span class="s1">&#39;pytest&#39;</span><span class="p">,</span> <span class="s1">&#39;nose&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;TestCase&#39;</span><span class="p">,</span> <span class="s1">&#39;@test&#39;</span><span class="p">,</span> <span class="s1">&#39;@pytest&#39;</span>
        <span class="p">]</span>
        <span class="n">has_tests</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">framework</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">framework</span> <span class="ow">in</span> <span class="n">test_frameworks</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest adding tests for non-test ML files without tests</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_test_file</span> <span class="ow">and</span> <span class="n">has_ml_operations</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_tests</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Unit Testing Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_data_leakage">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_data_leakage">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_data_leakage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for data preprocessing operations</span>
        <span class="n">preprocessing_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;fit_transform&#39;</span><span class="p">,</span> <span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;StandardScaler&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;MinMaxScaler&#39;</span><span class="p">,</span> <span class="s1">&#39;PCA&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_selection&#39;</span>
        <span class="p">]</span>
        <span class="n">has_preprocessing</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">preprocessing_ops</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for model training</span>
        <span class="n">has_model_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for proper train-test splitting</span>
        <span class="n">splitting_methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;train_test_split&#39;</span><span class="p">,</span> <span class="s1">&#39;KFold&#39;</span><span class="p">,</span> <span class="s1">&#39;StratifiedKFold&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GroupKFold&#39;</span><span class="p">,</span> <span class="s1">&#39;TimeSeriesSplit&#39;</span>
        <span class="p">]</span>
        <span class="n">has_proper_split</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">method</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">splitting_methods</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if preprocessing and training without proper splitting</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">has_preprocessing</span> <span class="ow">and</span> <span class="n">has_model_training</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_proper_split</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Data Leakage Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_exception_handling">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_exception_handling">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_exception_handling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for risky operations that should have exception handling</span>
        <span class="n">risky_operations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse_transform&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cross_val_score&#39;</span><span class="p">,</span> <span class="s1">&#39;GridSearchCV&#39;</span><span class="p">,</span> <span class="s1">&#39;load_&#39;</span><span class="p">,</span> <span class="s1">&#39;dump_&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;joblib&#39;</span>
        <span class="p">]</span>
        
        <span class="c1"># Find all risky operation calls</span>
        <span class="n">risky_calls</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">risky_operations</span><span class="p">)</span>
        <span class="p">]</span>
        
        <span class="c1"># Check if these calls are within try-except blocks</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">risky_calls</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">within_try_block</span> <span class="o">=</span> <span class="kc">False</span>
            
            <span class="k">while</span> <span class="n">parent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Try</span><span class="p">):</span>
                    <span class="n">within_try_block</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
            
            <span class="c1"># Only report if risky operations are not in try-except blocks</span>
            <span class="k">if</span> <span class="n">risky_calls</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">within_try_block</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;ScikitLearn&#39;</span><span class="p">,</span> <span class="s1">&#39;Exception Handling Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.check_imports">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.check_imports">[docs]</a>
    <span class="k">def</span> <span class="nf">check_imports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">import_node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">((</span><span class="n">nodes</span><span class="o">.</span><span class="n">Import</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ImportFrom</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">import_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Import</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">import_node</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;numpy&#39;</span> <span class="ow">and</span> <span class="n">alias</span> <span class="o">!=</span> <span class="s1">&#39;np&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Checker&#39;</span><span class="p">,</span> <span class="n">import_node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;pandas&#39;</span> <span class="ow">and</span> <span class="n">alias</span> <span class="o">!=</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Checker&#39;</span><span class="p">,</span> <span class="n">import_node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">import_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ImportFrom</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">import_node</span><span class="o">.</span><span class="n">modname</span> <span class="o">==</span> <span class="s1">&#39;numpy&#39;</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">alias</span> <span class="o">!=</span> <span class="s1">&#39;np&#39;</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">import_node</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Checker&#39;</span><span class="p">,</span> <span class="n">import_node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">import_node</span><span class="o">.</span><span class="n">modname</span> <span class="o">==</span> <span class="s1">&#39;pandas&#39;</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">alias</span> <span class="o">!=</span> <span class="s1">&#39;pd&#39;</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">import_node</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Checker&#39;</span><span class="p">,</span> <span class="n">import_node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


    <span class="c1"># PyTorch Detection Methods</span>
<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect PyTorch-specific code smells like:</span>
<span class="sd">        - Missing random seeds</span>
<span class="sd">        - Not using deterministic mode</span>
<span class="sd">        - DataLoader randomness issues</span>
<span class="sd">        - Missing masks for numerical operations</span>
<span class="sd">        - Direct forward() calls</span>
<span class="sd">        - Missing gradient zeroing</span>
<span class="sd">        - Missing batch normalization</span>
<span class="sd">        - Missing dropout</span>
<span class="sd">        - Missing data augmentation</span>
<span class="sd">        - Missing learning rate scheduling</span>
<span class="sd">        - Missing logging</span>
<span class="sd">        - Missing model evaluation mode</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_random_seed</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_deterministic</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_dataloader_random</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_mask</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_forward</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_grad_zero</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_batch_norm</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_dropout</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_augmentation</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_lr_scheduler</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_logging</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_pytorch_eval_mode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>

 

<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_random_seed">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_random_seed">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there are any random operations that need seeding</span>
        <span class="n">random_operations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;torch.rand&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.randn&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.randint&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;torch.randperm&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.bernoulli&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.normal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;torch.dropout&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.nn.Dropout&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_random_ops</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">random_operations</span>
        <span class="p">)</span>
        
        <span class="n">has_manual_seed</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;torch.manual_seed&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;torch.cuda.manual_seed&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;torch.cuda.manual_seed_all&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if random operations are used without seeding</span>
        <span class="k">if</span> <span class="n">has_random_ops</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_manual_seed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Randomness Control Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_deterministic">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_deterministic">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for operations that benefit from deterministic algorithms</span>
        <span class="n">deterministic_sensitive_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;torch.nn.Conv&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.nn.LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.nn.GRU&#39;</span><span class="p">,</span>
            <span class="s1">&#39;torch.backends.cudnn&#39;</span><span class="p">,</span> <span class="s1">&#39;torch.cuda&#39;</span><span class="p">,</span> <span class="s1">&#39;DataLoader&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_sensitive_ops</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">deterministic_sensitive_ops</span>
        <span class="p">)</span>
        
        <span class="n">has_deterministic_setting</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;torch.use_deterministic_algorithms&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;torch.backends.cudnn.deterministic&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if sensitive operations are used without deterministic setting</span>
        <span class="k">if</span> <span class="n">has_sensitive_ops</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_deterministic_setting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Deterministic Algorithm Usage Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_dataloader_random">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_dataloader_random">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_dataloader_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;DataLoader&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check if it&#39;s actually a PyTorch DataLoader</span>
                <span class="n">is_pytorch_dataloader</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="s1">&#39;torch&#39;</span> <span class="ow">in</span> <span class="n">imp</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
                    <span class="k">for</span> <span class="n">imp</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">ImportFrom</span><span class="p">)</span>
                <span class="p">)</span>
                
                <span class="c1"># Check if shuffling is enabled</span>
                <span class="n">has_shuffle</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;shuffle&#39;</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span>
                <span class="p">)</span>
                
                <span class="c1"># Check for proper random state control</span>
                <span class="n">has_random_control</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;worker_init_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;generator&#39;</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span>
                <span class="p">)</span>
                
                <span class="c1"># Only report if it&#39;s a PyTorch DataLoader with shuffling but no random control</span>
                <span class="k">if</span> <span class="n">is_pytorch_dataloader</span> <span class="ow">and</span> <span class="n">has_shuffle</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_random_control</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Randomness Control Checker (PyTorch-Dataloader)&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_mask">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_mask">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;torch.log&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check if the input might contain zeros or negative values</span>
                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">call</span><span class="o">.</span><span class="n">args</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">input_arg</span><span class="p">:</span>
                    <span class="c1"># Look for potential risky operations before the log</span>
                    <span class="n">risky_ops</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;randn&#39;</span><span class="p">,</span> <span class="s1">&#39;rand&#39;</span><span class="p">,</span> <span class="s1">&#39;sub&#39;</span><span class="p">,</span> <span class="s1">&#39;subtract&#39;</span><span class="p">]</span>
                    <span class="n">has_risky_input</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="n">op</span> <span class="ow">in</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
                        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">risky_ops</span>
                    <span class="p">)</span>
                    
                    <span class="c1"># Check if masking is applied</span>
                    <span class="n">has_mask</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span>
                        <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;clamp&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> 
                            <span class="s1">&#39;mask&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span> 
                            <span class="s1">&#39;where&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span>
                    <span class="p">)</span>
                    
                    <span class="c1"># Only report if there&#39;s a risk of invalid input without masking</span>
                    <span class="k">if</span> <span class="n">has_risky_input</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_mask</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Mask Missing Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_forward">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_forward">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;forward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check if it&#39;s a direct forward call on a neural network</span>
                <span class="n">is_nn_forward</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="s1">&#39;forward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">attrname</span> <span class="ow">and</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">parent_cls</span><span class="o">.</span><span class="n">bases</span> <span class="ow">and</span> 
                        <span class="s1">&#39;nn.Module&#39;</span> <span class="ow">in</span> <span class="n">parent_cls</span><span class="o">.</span><span class="n">bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">parent_cls</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">))</span>
                <span class="p">)</span>
                
                <span class="c1"># Check if it&#39;s called directly instead of using __call__</span>
                <span class="n">is_direct_call</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;net.forward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
                    <span class="s1">&#39;model.forward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
                <span class="p">)</span>
                
                <span class="c1"># Only report if it&#39;s a direct forward call on an nn.Module</span>
                <span class="k">if</span> <span class="n">is_nn_forward</span> <span class="ow">and</span> <span class="n">is_direct_call</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Net Forward Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_grad_zero">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_grad_zero">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_grad_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s actual training happening</span>
        <span class="n">has_training_loop</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;loss.backward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;backward()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_optimizer</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;optim.&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_grad_zero</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;zero_grad&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;set_to_none&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>  <span class="c1"># Alternative method</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if there&#39;s training without gradient zeroing</span>
        <span class="k">if</span> <span class="n">has_training_loop</span> <span class="ow">and</span> <span class="n">has_optimizer</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_grad_zero</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Gradient Clear Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_batch_norm">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_batch_norm">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_batch_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if it&#39;s a CNN or deep network that could benefit from BatchNorm</span>
        <span class="n">conv_layers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;Conv1d&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv2d&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv3d&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ConvTranspose1d&#39;</span><span class="p">,</span> <span class="s1">&#39;ConvTranspose2d&#39;</span><span class="p">,</span> <span class="s1">&#39;ConvTranspose3d&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_conv_layers</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">conv_layers</span>
        <span class="p">)</span>
        
        <span class="n">has_deep_structure</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv&#39;</span><span class="p">])</span>
        <span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span>
        
        <span class="n">has_batch_norm</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;BatchNorm&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest BatchNorm for appropriate architectures</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">has_conv_layers</span> <span class="ow">or</span> <span class="n">has_deep_structure</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_batch_norm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch Normalisation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_dropout">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_dropout">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_dropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if the model is complex enough to benefit from dropout</span>
        <span class="n">has_multiple_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
                  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU&#39;</span><span class="p">])</span>
        <span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span>
        
        <span class="n">has_training_code</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;train()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;backward()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_dropout</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;Dropout&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest dropout for complex models during training</span>
        <span class="k">if</span> <span class="n">has_multiple_layers</span> <span class="ow">and</span> <span class="n">has_training_code</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_dropout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Dropout Usage Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_augmentation">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_augmentation">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_augmentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if it&#39;s a computer vision task</span>
        <span class="n">vision_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;ImageFolder&#39;</span><span class="p">,</span> <span class="s1">&#39;Dataset&#39;</span><span class="p">,</span> <span class="s1">&#39;DataLoader&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Conv2d&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv3d&#39;</span><span class="p">,</span> <span class="s1">&#39;ResNet&#39;</span><span class="p">,</span> <span class="s1">&#39;VGG&#39;</span><span class="p">,</span>
            <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="s1">&#39;PIL&#39;</span>
        <span class="p">]</span>
        
        <span class="n">is_vision_task</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">vision_indicators</span>
        <span class="p">)</span>
        
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;train()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_augmentation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;transforms&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;augment&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest augmentation for vision tasks during training</span>
        <span class="k">if</span> <span class="n">is_vision_task</span> <span class="ow">and</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_augmentation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Data Augmentation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_lr_scheduler">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_lr_scheduler">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_lr_scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s a training loop with enough epochs</span>
        <span class="n">has_epochs</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;epoch&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Try to determine the number of epochs</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">epoch_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="n">has_epochs</span> <span class="o">=</span> <span class="n">epoch_num</span> <span class="o">&gt;</span> <span class="mi">10</span>  <span class="c1"># Suggest scheduler for longer training</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">continue</span>
        
        <span class="n">has_optimizer</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;optim.&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_scheduler</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;lr_scheduler&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;LRScheduler&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest scheduler for long training processes</span>
        <span class="k">if</span> <span class="n">has_epochs</span> <span class="ow">and</span> <span class="n">has_optimizer</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_scheduler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Learning Rate Scheduler Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_logging">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_logging">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s actual training to log</span>
        <span class="n">has_training_loop</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;train()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;backward()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_metrics</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">metric</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;metric&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">has_logging</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">logger</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;tensorboard&#39;</span><span class="p">,</span> <span class="s1">&#39;SummaryWriter&#39;</span><span class="p">,</span> <span class="s1">&#39;wandb&#39;</span><span class="p">,</span>
                <span class="s1">&#39;MLflow&#39;</span><span class="p">,</span> <span class="s1">&#39;Neptune&#39;</span><span class="p">,</span> <span class="s1">&#39;logger&#39;</span>
            <span class="p">]</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest logging for training with metrics</span>
        <span class="k">if</span> <span class="n">has_training_loop</span> <span class="ow">and</span> <span class="n">has_metrics</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Logging Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_pytorch_eval_mode">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_pytorch_eval_mode">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_pytorch_eval_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s validation/testing happening</span>
        <span class="n">evaluation_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;val_loader&#39;</span><span class="p">,</span> <span class="s1">&#39;test_loader&#39;</span><span class="p">,</span> <span class="s1">&#39;validate&#39;</span><span class="p">,</span>
            <span class="s1">&#39;evaluation&#39;</span><span class="p">,</span> <span class="s1">&#39;testing&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_evaluation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">evaluation_indicators</span>
        <span class="p">)</span>
        
        <span class="n">has_model_usage</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;forward&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;model(&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_eval_mode</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;eval()&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;train(False)&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest eval mode when doing validation/testing</span>
        <span class="k">if</span> <span class="n">has_evaluation</span> <span class="ow">and</span> <span class="n">has_model_usage</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_eval_mode</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;PyTorch&#39;</span><span class="p">,</span> <span class="s1">&#39;Model Evaluation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


    <span class="c1"># TensorFlow Detection Methods</span>
<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tensorflow_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tensorflow_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tensorflow_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect TensorFlow-specific code smells like:</span>
<span class="sd">        - Missing random seeds</span>
<span class="sd">        - Missing early stopping</span>
<span class="sd">        - Missing checkpointing</span>
<span class="sd">        - Memory leaks</span>
<span class="sd">        - Missing masks</span>
<span class="sd">        - Python lists instead of TensorArrays</span>
<span class="sd">        - Missing threshold-independent metrics</span>
<span class="sd">        - Missing logging</span>
<span class="sd">        - Missing batch normalization</span>
<span class="sd">        - Missing dropout</span>
<span class="sd">        - Missing data augmentation</span>
<span class="sd">        - Missing learning rate scheduling</span>
<span class="sd">        - Missing model evaluation</span>

<span class="sd">        Args:</span>
<span class="sd">            node: AST node representing the Python module</span>
<span class="sd">            file_path: Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_random_seed</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_early_stopping</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_checkpointing</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_memory_release</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_mask</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_tensor_array</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_metrics</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_logging</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_batch_norm</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_dropout</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_augmentation</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_lr_scheduler</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_tf_model_evaluation</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>



<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_random_seed">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_random_seed">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for operations that need random seed control</span>
        <span class="n">random_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;random.normal&#39;</span><span class="p">,</span> <span class="s1">&#39;random.uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;random.shuffle&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dropout&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomRotation&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomFlip&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomZoom&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_random_ops</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">random_ops</span>
        <span class="p">)</span>
        
        <span class="n">has_seed_set</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;random.set_seed&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;set_random_seed&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only report if random operations are used without seed</span>
        <span class="k">if</span> <span class="n">has_random_ops</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_seed_set</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Randomness Control Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_early_stopping">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_early_stopping">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_early_stopping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s actual model training</span>
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model.fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;fit(&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Check for training loop with multiple epochs</span>
        <span class="n">has_multiple_epochs</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;epochs&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">keywords</span>
        <span class="p">)</span>
        
        <span class="n">has_early_stopping</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;EarlyStopping&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest early stopping for actual training with multiple epochs</span>
        <span class="k">if</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="n">has_multiple_epochs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_early_stopping</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Early Stopping Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_checkpointing">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_checkpointing">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_checkpointing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for model training and complexity</span>
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model.fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_complex_model</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">layer</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">has_checkpointing</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;ModelCheckpoint&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;save_weights&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest checkpointing for complex models during training</span>
        <span class="k">if</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="n">has_complex_model</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_checkpointing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Checkpointing Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_memory_release">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_memory_release">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_memory_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for memory-intensive operations</span>
        <span class="n">memory_intensive_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;model.fit&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;evaluate&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Conv&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU&#39;</span><span class="p">,</span> <span class="s1">&#39;Attention&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_intensive_ops</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">memory_intensive_ops</span>
        <span class="p">)</span>
        
        <span class="n">has_memory_release</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;clear_session&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;reset_states&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest memory release for memory-intensive operations</span>
        <span class="k">if</span> <span class="n">has_intensive_ops</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_memory_release</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Memory Release Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_mask">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_mask">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;tf.math.log&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">():</span>
                <span class="c1"># Check for potential zero/negative inputs</span>
                <span class="n">input_arg</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">call</span><span class="o">.</span><span class="n">args</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">input_arg</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">input_arg</span><span class="p">,</span> <span class="s1">&#39;as_string&#39;</span><span class="p">):</span>  <span class="c1"># Add null check</span>
                    <span class="n">risky_ops</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;subtract&#39;</span><span class="p">,</span> <span class="s1">&#39;sub&#39;</span><span class="p">]</span>
                    <span class="n">has_risky_input</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="n">op</span> <span class="ow">in</span> <span class="n">input_arg</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">risky_ops</span>
                    <span class="p">)</span>
                    
                    <span class="n">has_mask</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span>
                        <span class="nb">any</span><span class="p">(</span><span class="n">mask_op</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
                            <span class="k">for</span> <span class="n">mask_op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">,</span> <span class="s1">&#39;clip&#39;</span><span class="p">,</span> <span class="s1">&#39;maximum&#39;</span><span class="p">])</span>
                    <span class="p">)</span>
                    
                    <span class="c1"># Only report if there&#39;s risk of invalid input without masking</span>
                    <span class="k">if</span> <span class="n">has_risky_input</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_mask</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Mask Missing Checker&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_tensor_array">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_tensor_array">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_tensor_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check for dynamic sequence operations</span>
        <span class="n">dynamic_ops</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;RNN&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU&#39;</span><span class="p">,</span> <span class="s1">&#39;while_loop&#39;</span><span class="p">,</span>
            <span class="s1">&#39;map_fn&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">,</span> <span class="s1">&#39;dynamic&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_dynamic_ops</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">op</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">dynamic_ops</span>
        <span class="p">)</span>
        
        <span class="n">using_python_list</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;append&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;extend&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_tensor_array</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;TensorArray&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest TensorArray for dynamic operations using Python lists</span>
        <span class="k">if</span> <span class="n">has_dynamic_ops</span> <span class="ow">and</span> <span class="n">using_python_list</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_tensor_array</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Tensor Array Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_metrics">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_metrics">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if it&#39;s a classification task</span>
        <span class="n">classification_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;Binary&#39;</span><span class="p">,</span> <span class="s1">&#39;Categorical&#39;</span><span class="p">,</span> <span class="s1">&#39;sparse_categorical&#39;</span><span class="p">,</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span>
        <span class="p">]</span>
        
        <span class="n">is_classification</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">classification_indicators</span>
        <span class="p">)</span>
        
        <span class="n">has_basic_metrics</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">metric</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">has_threshold_independent</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">metric</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AUC&#39;</span><span class="p">,</span> <span class="s1">&#39;AUROCScore&#39;</span><span class="p">,</span> <span class="s1">&#39;PrecisionRecallCurve&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest threshold-independent metrics for classification tasks</span>
        <span class="k">if</span> <span class="n">is_classification</span> <span class="ow">and</span> <span class="n">has_basic_metrics</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_threshold_independent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Dependent Threshold Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_logging">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_logging">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s actual training to log</span>
        <span class="n">has_training_loop</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model.fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;train&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_metrics</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">metric</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="s1">&#39;metric&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">has_logging</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">logger</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;tf.summary&#39;</span><span class="p">,</span> <span class="s1">&#39;TensorBoard&#39;</span><span class="p">,</span> <span class="s1">&#39;CSVLogger&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WandbCallback&#39;</span><span class="p">,</span> <span class="s1">&#39;MLflow&#39;</span>
            <span class="p">]</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest logging for training with metrics</span>
        <span class="k">if</span> <span class="n">has_training_loop</span> <span class="ow">and</span> <span class="n">has_metrics</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Logging Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_batch_norm">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_batch_norm">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_batch_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if it&#39;s a deep network that could benefit from BatchNorm</span>
        <span class="n">conv_layers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;Conv1D&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv2D&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv3D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;SeparableConv&#39;</span>
        <span class="p">]</span>
        
        <span class="n">has_conv_layers</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">conv_layers</span>
        <span class="p">)</span>
        
        <span class="c1"># Check if model is deep enough</span>
        <span class="n">layer_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
                  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">conv_layers</span><span class="p">)</span>
        <span class="p">])</span>
        
        <span class="n">has_batch_norm</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;BatchNormalization&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest BatchNorm for deep networks with conv layers</span>
        <span class="k">if</span> <span class="n">has_conv_layers</span> <span class="ow">and</span> <span class="n">layer_count</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_batch_norm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch Normalisation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_dropout">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_dropout">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_dropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if model is complex enough to need dropout</span>
        <span class="n">deep_layers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU&#39;</span><span class="p">]</span>
        
        <span class="n">layer_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
            <span class="n">call</span> <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">layer</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
                  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">deep_layers</span><span class="p">)</span>
        <span class="p">])</span>
        
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model.fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;training=True&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_dropout</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;Dropout&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest dropout for complex models during training</span>
        <span class="k">if</span> <span class="n">layer_count</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_dropout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Dropout Usage Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_augmentation">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_augmentation">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_augmentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if it&#39;s a computer vision task</span>
        <span class="n">vision_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv2D&#39;</span><span class="p">,</span> <span class="s1">&#39;Conv3D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ImageDataGenerator&#39;</span><span class="p">,</span> <span class="s1">&#39;load_img&#39;</span>
        <span class="p">]</span>
        
        <span class="n">is_vision_task</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">indicator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">vision_indicators</span>
        <span class="p">)</span>
        
        <span class="n">has_training</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model.fit&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;train&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_augmentation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">aug</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> 
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">aug</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ImageDataGenerator&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomFlip&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomRotation&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomZoom&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest augmentation for vision tasks during training</span>
        <span class="k">if</span> <span class="n">is_vision_task</span> <span class="ow">and</span> <span class="n">has_training</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_augmentation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Data Augmentation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_lr_scheduler">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_lr_scheduler">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_lr_scheduler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s a long training process</span>
        <span class="n">has_epochs</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">For</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;epoch&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">epoch_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="n">has_epochs</span> <span class="o">=</span> <span class="n">epoch_num</span> <span class="o">&gt;</span> <span class="mi">5</span>  <span class="c1"># Suggest scheduler for longer training</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">continue</span>
        
        <span class="n">has_optimizer</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;optimizer&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_scheduler</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;LearningRateScheduler&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;schedules&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;ReduceLROnPlateau&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest scheduler for long training processes</span>
        <span class="k">if</span> <span class="n">has_epochs</span> <span class="ow">and</span> <span class="n">has_optimizer</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_scheduler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Learning Rate Scheduler Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.detect_tf_model_evaluation">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.detect_tf_model_evaluation">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_tf_model_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Check if there&#39;s a model to evaluate</span>
        <span class="n">has_model</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;model&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;Sequential&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;Model(&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">has_test_data</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">data</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;valid&#39;</span><span class="p">,</span> <span class="s1">&#39;evaluation&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">has_evaluation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s1">&#39;evaluate&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="ow">or</span>
            <span class="s1">&#39;predict&#39;</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Only suggest evaluation when there&#39;s a model and test data</span>
        <span class="k">if</span> <span class="n">has_model</span> <span class="ow">and</span> <span class="n">has_test_data</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_evaluation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span><span class="s1">&#39;TensorFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;Model Evaluation Checker&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span></div>



<div class="viewcode-block" id="FrameworkSpecificSmellDetector.generate_report">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.generate_report">[docs]</a>
    <span class="k">def</span> <span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a detailed text report of all detected code smells.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A formatted string containing the analysis report with:</span>
<span class="sd">            - Framework-specific smell counts</span>
<span class="sd">            - Details for each smell including location and fixes</span>
<span class="sd">            - Total number of smells detected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">report</span> <span class="o">=</span> <span class="s2">&quot;Framework-Specific Code Smell Report</span><span class="se">\n</span><span class="s2">====================================</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="n">smell_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">smell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">smells</span><span class="p">:</span>
            <span class="n">framework</span> <span class="o">=</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;framework&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">framework</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">smell_counts</span><span class="p">:</span>
                <span class="n">smell_counts</span><span class="p">[</span><span class="n">framework</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">smell_counts</span><span class="p">[</span><span class="n">framework</span><span class="p">]:</span>
                <span class="n">smell_counts</span><span class="p">[</span><span class="n">framework</span><span class="p">][</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">smell_counts</span><span class="p">[</span><span class="n">framework</span><span class="p">][</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Framework: </span><span class="si">{</span><span class="n">framework</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Smell: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;file_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            
            <span class="k">if</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;line_number&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Line: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;line_number&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            
            <span class="n">code_lines</span> <span class="o">=</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;code_snippet&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_lines</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Code Snippet:</span><span class="se">\n</span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;code_snippet&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;How to Fix: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;how_to_fix&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Benefits: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;benefits&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Strategies: </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;strategies&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>

        <span class="n">report</span> <span class="o">+=</span> <span class="s2">&quot;Smell Counts:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">framework</span><span class="p">,</span> <span class="n">counts</span> <span class="ow">in</span> <span class="n">smell_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">framework</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">smell</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">smell</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">report</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total smells detected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smells</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">report</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.get_results">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.get_results">[docs]</a>
    <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a simplified list of detected code smells.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of dictionaries containing:</span>
<span class="sd">            - framework: The ML framework</span>
<span class="sd">            - name: Name of the smell</span>
<span class="sd">            - fix: How to fix it</span>
<span class="sd">            - benefits: Benefits of fixing</span>
<span class="sd">            - location: Where it was found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;framework&#39;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;framework&#39;</span><span class="p">],</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;how_to_fix&#39;</span><span class="p">],</span>
                <span class="s1">&#39;benefits&#39;</span><span class="p">:</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;benefits&#39;</span><span class="p">],</span>
                <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">smell</span><span class="p">[</span><span class="s1">&#39;line_number&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">smell</span><span class="p">[</span><span class="s1">&#39;line_number&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">smell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">smells</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="FrameworkSpecificSmellDetector.get_smells">
<a class="viewcode-back" href="../../../detectors/framework_detector.html#ml_code_smell_detector.FrameworkSpecificSmellDetector.get_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">get_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;General&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Import Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use standard naming conventions for imported modules.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves code readability and maintainability.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Follow standard naming conventions (e.g., import numpy as np, import pandas as pd).&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;Pandas&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Unnecessary Iteration&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use vectorized operations instead of loops.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enhances performance and reduces execution time.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Replace loops with Pandas vectorized functions (e.g., apply, map, vectorized arithmetic operations).&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DataFrame Iteration Modification&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Avoid modifying DataFrame during iteration.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents unexpected behaviour and potential data corruption.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use temporary variables or vectorized operations for modifications.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Chain Indexing&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use single indexing or .loc[], .iloc[] methods.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enhances code readability and prevents performance issues.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use .loc[] or .iloc[] for DataFrame indexing instead of chained indexing.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Datatype Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set data types explicitly when importing data.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures correct data format and reduces memory usage.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use dtype parameter in Pandas read functions (e.g., pd.read_csv).&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Column Selection Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Select necessary columns after importing DataFrame.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Clarifies data usage and improves performance.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use column selection methods (e.g., df[[&#39;col1&#39;, &#39;col2&#39;]]).&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Merge Parameter Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Specify how, on, and validate parameters in merge operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures accurate data merging and prevents data loss.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use appropriate parameters in pd.merge function.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;InPlace Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Assign operations to a new DataFrame variable.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents data loss and improves code clarity.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Assign operation results to a new variable instead of using inplace=True.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DataFrame Conversion Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use .to_numpy() instead of .values.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures future compatibility and avoids unexpected behaviour.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Replace .values with .to_numpy() in Pandas DataFrame conversion.&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;NumPy&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;NaN Equality Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use np.isnan() to check for NaN values.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures accurate data handling and avoids logical errors.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Replace == np.nan with np.isnan().&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Randomness Control Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use np.random.seed() for reproducibility.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enables reproducible results and debugging.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Set random seed using np.random.seed(seed_value).&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Array Creation Efficiency&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Specify dtype when creating arrays.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves memory efficiency and avoids unnecessary conversions.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use dtype parameter in np.array, np.zeros, np.ones, np.empty functions.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Inefficient Operations&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Optimize numerical operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves performance and reduces execution time.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use vectorized functions instead of loops for element-wise operations.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dtype Consistency&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensure consistent data types in operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves accuracy and avoids logical errors.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use consistent data types in np.sum, np.mean, np.max, np.min functions.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Broadcasting Risk&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Specify axis in operations between arrays.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves performance and avoids broadcasting issues.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use axis parameter in np.reshape, np.transpose functions.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Copy-View Confusion&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Explicitly copy arrays before slicing.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves performance and avoids unexpected behaviour.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use .copy() method or np.copy function before slicing.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Missing Axis Specification&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Specify axis in array operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves performance and avoids unexpected behaviour.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use axis parameter in np.sum, np.mean, np.max, np.min, np.argmax, np.argmin, np.any, np.all functions.&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;ScikitLearn&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Scaler Missing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Apply scaling before scaling-sensitive operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves model performance and accuracy.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use StandardScaler, MinMaxScaler, etc., before applying PCA, SVM, etc.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Pipeline Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use Pipelines for all scikit-learn estimators.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents data leakage and ensures correct model evaluation.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement Pipeline from sklearn.pipeline for preprocessing and model fitting.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cross Validation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement cross-validation techniques for robust model evaluation.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enhances model performance and reduces overfitting.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use cross_val_score, KFold, or other cross-validation methods.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Randomness Control Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set random_state in estimators for reproducibility.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures reproducible results and consistent model behaviour.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Set random_state to a fixed value in scikit-learn estimators.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Verbose Mode Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable verbose mode for long training processes.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Provides better insights into model training progress.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Set verbose=True in scikit-learn estimators with long training times.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dependent Threshold Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use threshold-independent metrics alongside threshold-dependent ones.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Provides a comprehensive evaluation of model performance.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Include metrics like ROC AUC score alongside accuracy or F1-score.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Unit Testing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Write unit tests for data processing and model components.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures code reliability and prevents bugs.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use unittest or pytest to write and run tests for individual components.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Leakage Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Split data before any preprocessing or feature engineering.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents data leakage and ensures valid model evaluation.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use train_test_split before any data preprocessing steps.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Exception Handling Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement proper exception handling for model operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves code robustness and error reporting.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use try-except blocks to handle potential exceptions in model training and prediction.&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;PyTorch&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Randomness Control Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set random seed using torch.manual_seed() for reproducibility.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures reproducible results across different runs.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add torch.manual_seed(seed_value) at the start of your script.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deterministic Algorithm Usage Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable deterministic algorithms using torch.use_deterministic_algorithms(True).&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures consistent results across different hardware and runs.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Set torch.use_deterministic_algorithms(True) and handle any required adjustments.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Randomness Control Checker (PyTorch-Dataloader)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set worker_init_fn and generator in DataLoader for reproducible data loading.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures consistent data loading across different runs.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Configure worker_init_fn and generator parameters in DataLoader initialization.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mask Missing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use appropriate masking when dealing with log operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents numerical errors and improves model stability.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Apply masks before log operations to handle invalid values.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Net Forward Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use model(input) instead of model.forward(input).&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Follows PyTorch best practices and handles hooks properly.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Replace direct forward() calls with the recommended calling syntax.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gradient Clear Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Clear gradients before each backward pass using optimizer.zero_grad().&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents gradient accumulation and ensures correct updates.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add optimizer.zero_grad() before loss.backward() in training loop.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Batch Normalisation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Include BatchNorm layers in your model architecture.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves training stability and model convergence.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add torch.nn.BatchNorm layers after convolutional or linear layers.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dropout Usage Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Include Dropout layers for regularization.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Reduces overfitting and improves model generalization.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add torch.nn.Dropout layers in your model architecture.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Augmentation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement data augmentation using torchvision.transforms.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves model robustness and reduces overfitting.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use torchvision.transforms to apply various augmentation techniques.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Learning Rate Scheduler Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement learning rate scheduling.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves training convergence and final model performance.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use torch.optim.lr_scheduler for dynamic learning rate adjustment.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Logging Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement proper logging using tensorboard or similar tools.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enables better experiment tracking and debugging.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use tensorboardX or torch.utils.tensorboard for logging.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Model Evaluation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set model to evaluation mode using model.eval().&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures correct behavior of layers like BatchNorm and Dropout during inference.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Call model.eval() before validation/testing and model.train() before training.&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;TensorFlow&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Randomness Control Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Set random seed using tf.random.set_seed().&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures reproducible results across different runs.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add tf.random.set_seed(seed_value) at the start of your script.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Early Stopping Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement early stopping using tf.keras.callbacks.EarlyStopping.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents overfitting and reduces unnecessary training time.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add EarlyStopping callback to model.fit().&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Checkpointing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement model checkpointing using tf.keras.callbacks.ModelCheckpoint.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enables model recovery and saves best performing models.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add ModelCheckpoint callback to model.fit().&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Memory Release Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Clear session after model creation/training using tf.keras.backend.clear_session().&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents memory leaks and reduces resource usage.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Call clear_session() after completing major operations.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mask Missing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use appropriate masking for log operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevents numerical errors and improves model stability.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Apply masks before log operations to handle invalid values.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Tensor Array Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use tf.TensorArray for dynamic tensor operations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves memory efficiency for dynamic computations.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Replace Python lists with tf.TensorArray for growing tensors.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dependent Threshold Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Use threshold-independent metrics like AUC.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Provides more robust model evaluation.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Include tf.keras.metrics.AUC in your model metrics.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Logging Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement TensorBoard logging.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Enables better experiment tracking and visualization.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use tf.summary or TensorBoard callbacks for logging.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Batch Normalisation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Include BatchNormalization layers in your model.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves training stability and model convergence.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add tf.keras.layers.BatchNormalization layers to your model.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dropout Usage Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Include Dropout layers for regularization.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Reduces overfitting and improves generalization.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Add tf.keras.layers.Dropout layers to your model.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Augmentation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement data augmentation using ImageDataGenerator.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves model robustness and reduces overfitting.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use tf.keras.preprocessing.image.ImageDataGenerator for augmentation.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Learning Rate Scheduler Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement learning rate scheduling.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves training convergence and final model performance.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use LearningRateScheduler callback or custom scheduling.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Model Evaluation Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Evaluate model performance using model.evaluate().&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Provides standardized model evaluation.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use model.evaluate() on validation/test data.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Unit Testing Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement unit tests using tf.test.TestCase.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensures code reliability and prevents regressions.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Create test classes inheriting from tf.test.TestCase.&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Exception Handling Checker&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;how_to_fix&quot;</span><span class="p">:</span> <span class="s2">&quot;Implement proper exception handling.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;benefits&quot;</span><span class="p">:</span> <span class="s2">&quot;Improves code robustness and error reporting.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;strategies&quot;</span><span class="p">:</span> <span class="s2">&quot;Use try-except blocks to handle TensorFlow-specific exceptions.&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span></div>
</div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Your Name.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>